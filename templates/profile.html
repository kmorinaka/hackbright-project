{% extends 'base.html' %}

{% block title %}User Profile{% endblock %}

{% block head %}
<style>
        html, body {width: 100%; height: 100%}
        body {margin: 0; padding: 0; overflow:hidden;}
        #map, #map-container {height: 600px; margin: 0px;}
        #map-container {padding-top: 50px;}

        
    </style>

    <script src="https://maps.googleapis.com/maps/api/js"></script>
    <script src="https://code.jquery.com/jquery.js"></script>

<script>
 function initialize() {
        var map = new google.maps.Map(document.getElementById('map'), mapOptions);
        // FIX THE USER PROFILE MAP OF THEIR SAVED BUSINESSES
        var businesses = {{ businesses }} 

        var mapOptions = {
              zoom: 12,
              center: new google.maps.LatLng(businesses[0].latitude, businesses[0].longitude)
            };

        map = new google.maps.Map(
            document.getElementById('map'),
            mapOptions);

        console.log('hello');
     

        for (var i=0; i < businesses.length; i++) {
            var myLatLng = new google.maps.LatLng(businesses[i].latitude, businesses[i].longitude);
            
            var marker = new google.maps.Marker({
                position: myLatLng,
                map: map,
                title: businesses[i].name
             });
        }
        
    };

    google.maps.event.addDomListener(window, 'load', initialize);

// for business in businesses:
// get the attribute data-coordinates (on the <a>)


    // function createMarker(business, point) {
    //     var latLng = new google.maps.latLng(coordinates) //fill in lat/lon from search results
    //     var marker = new google.maps.Marker({
    //         position: latLng,
    //         map: map,
    //         title: '',
    //         icon: //optional, deal with later
    //     })
    // }
</script>
{% endblock %}

{% block content %}

<div class="row">
  <div class="container-fluid" class="col-md-6">    
    <div class="userinfo">
        <h3><b>{{ user.username }}</b></h3>
        <p>You live in: {{ user.city }}, {{ user.state }}</p>
        <p>Email: {{ user.email }}</p>
    </div>

    <div class="businesses">
        {% for business in businesses %}
            <h4>{{ business.name }}</h4>
            <p>{{ business.address }} {{ business.city }}, {{ business.state}}</p>
            
        {% endfor %}
    </div>


  </div> <!-- closes container with userinfo and businesses -->

  <div class="col-md-6">
    <div id="map-container">
        <div id="map"></div>
    </div>
  </div>
</div> <!-- closes row -->

{% endblock %}
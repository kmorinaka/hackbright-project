{% extends 'base.html' %}

{% block title %}Search Results{% endblock %}
{% block content %}
    <div class="container-fluid">
        <h1>Results:</h1>
        <br>
        <div class="container" id="clickme">
            <ul>
               {% for business in businesses %}
               
                    
                    <span class="info" data-name="{{ business['name'] }}"
                data-address="{{ business['address'] }}"
                data-city="{{ business['city'] }}"
                data-state="{{ business['state'] }}"
                data-zipcode="{{ business['zipcode'] }}"
                data-phone="{{ business['phone'] }}"
                data-categories="{{ business['categories'] }}"
                data-id="{{ business['id'] }}"
                data-yelp-url="{{ business['yelp_url'] }}"
                data-rating="{{ business['rating'] }}"
                data-url-rating-stars="{{ business['url_rating_stars'] }}"
                data-neighborhoods="{{ business['neighborhoods'] }}"
                data-cross-streets="{{ business['cross_streets'] }}"
                data-coordinates="{{ business['coordinates'] }}">
            <a href='/profile'> {{ business['name'] }}</a></span>

                
                    <li>Address: {{ business['address'] }} {{ business['city'] }}, {{ business['state'] }} {{ business['zipcode'] }}</li>
                    <li>Phone number: {{ business['phone'] }}</li>
                    <li>Categories: {{ business['categories']}}</li>
                {% endfor %}
                <br><br>
            </ul>
        </div>
   </div>
    <script> 
    //make url safe version of all data attributes  ?address=45Miss&city=
        //use window.href to send a get request with all data attributes in the url

        //when they click on the business name, the function getProfile, gets the data from the data attributes
        $("a").on("click", function(evt) {
            evt.preventDefault();
            console.log($(evt.currentTarget));
            // debugger;
            var businessInfo = $(evt.currentTarget).context.parentNode.attributes;
            console.log(businessInfo);
            alert('clicked!');
            
            $.post('/profile', businessInfo, function(){
                alert('i came back from the server')
            });
        });

        var form = document.createElement('FORM');
        form


        //data is saved in an object under the variable name businessInfo
 
    </script>
    <!--
    add data- attribute for each key in business dictionary

    in javascript attach a click event to the span with id bname
    event handler for that click even will be a get request to the /profile route

    image for business

    display business info
    link to yelp
    map?

    yelp html to display star ratings

        <i class="star-img stars_4_half" title="4.5 star rating">
            <img alt="4.5 star rating" class="offscreen" height="303" src="//s3-media4.fl.yelpcdn.com/assets/srv0/yelp_styleguide/c2252a4cd43e/assets/img/stars/stars_map.png" width="84">
        </i>
    
    -->
{% endblock %}